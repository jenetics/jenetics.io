<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_152) on Thu Nov 16 20:11:40 CET 2017 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>io.jenetics.prog (Jenetics 4.0.0)</title>
<meta name="date" content="2017-11-16">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="io.jenetics.prog (Jenetics 4.0.0)";
        }
    }
    catch(err) {
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Package</li>
<li><a href="../../../io/jenetics/prog/op/package-summary.html">Next&nbsp;Package</a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?io/jenetics/prog/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<div class="header">
<h1 title="Package" class="title">Package&nbsp;io.jenetics.prog</h1>
<div class="docSummary">
<div class="block">Example</div>
</div>
<p>See:&nbsp;<a href="#package.description">Description</a></p>
</div>
<div class="contentContainer">
<ul class="blockList">
<li class="blockList">
<table class="typeSummary" border="0" cellpadding="3" cellspacing="0" summary="Class Summary table, listing classes, and an explanation">
<caption><span>Class Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Class</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../io/jenetics/prog/ProgramChromosome.html" title="class in io.jenetics.prog">ProgramChromosome</a>&lt;A&gt;</td>
<td class="colLast">
<div class="block">Holds the nodes of the operation tree.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../io/jenetics/prog/ProgramGene.html" title="class in io.jenetics.prog">ProgramGene</a>&lt;A&gt;</td>
<td class="colLast">
<div class="block">This gene represents a program, build upon an AST of <a href="../../../io/jenetics/prog/op/Op.html" title="interface in io.jenetics.prog.op"><code>Op</code></a> functions.</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<a name="package.description">
<!--   -->
</a>
<h2 title="Package io.jenetics.prog Description">Package io.jenetics.prog Description</h2>
<div class="block"><h2>Example</h2>

 The following example shows how to solve a GP problem with <em>Jenetics</em>.
 We are trying to find a polynomial (or an arbitrary mathematical function)
 which approximates a given data set.

 <table summary="Sample points">
     <tr><th>x</th><th>y</th></tr>
     <tr><td>0.00</td><td>0.0000</td></tr>
     <tr><td>0.10</td><td>0.0740</td></tr>
     <tr><td>0.20</td><td>0.1120</td></tr>
     <tr><td>0.30</td><td>0.1380</td></tr>
     <tr><td>...</td><td>...</td></tr>
 </table>

 The sample points has been created with the function
 <em>f(x) = 4*x^3 - 3*x^2 + x</em>. The knowledge of the creating function
 makes it easier to compare the quality of the evolved function. For the
 example we created 21 data points.

 <p>
     <b>NOTE</b>: <em>The function which created the sample points is not
     needed in the error function we have to define for the GP. It just let
     us verify the final, evolved result.</em>
 </p>

 As first step, we have to define the set of allowed <em>non-terminal</em>
 and the <em>terminal</em> operations the GP is working with. Selecting the
 right set of operation has a big influence on the performance of the GP. If
 the operation set is bigger than necessary, we will expand the potential
 search space, and the execution time for finding a solution. For our
 <em>polynomial</em> example we will chose the following <em>operations</em>
 and <em>terminals</em>.

 <div class="code"><code lang="java">
 <font color="#7F0055"><b>static</b></font> <font color="#7F0055"><b>final</b></font> ISeq&lt;Op&lt;Double&gt;&gt; OPERATIONS = ISeq.of(
     MathOp.ADD,
     MathOp.SUB,
     MathOp.MUL
 );

 <font color="#7F0055"><b>static</b></font> <font color="#7F0055"><b>final</b></font> ISeq&lt;Op&lt;Double&gt;&gt; TERMINALS = ISeq.of(
     Var.of(<font color="#0000FF">"x"</font>, 0),
     EphemeralConst.of(() -&gt; (<font color="#7F0055"><b>double</b></font>)RandomRegistry.getRandom().nextInt(10))
 );</code></div>

 The chosen non-terminal operation set is sufficient to create any polynomial.
 For the terminal operations, we added a variable "x", with index zero, and
 an ephemeral integer constant. The purpose of the ephemeral constant is to
 create constant values, which will differ for every tree, but stay constant
 within a tree.
 <p>
 In the next step define the fitness function for the GP, which will be an
 error function we will minimize.

 <div class="code"><code lang="java">
 <font color="#3F7F5F">// The lookup table where the data points are stored.</font>
 <font color="#7F0055"><b>static</b></font> <font color="#7F0055"><b>final</b></font> <font color="#7F0055"><b>double</b></font>[][] SAMPLES = <font color="#7F0055"><b>new</b></font> <font color="#7F0055"><b>double</b></font>[][] {
     {-1.0, -8.0000},
     {-0.9, -6.2460},
     ...
 };

 <font color="#7F0055"><b>static</b></font> <font color="#7F0055"><b>double</b></font> error(<font color="#7F0055"><b>final</b></font> ProgramGene&lt;Double&gt; program) {
     <font color="#7F0055"><b>return</b></font> Arrays.stream(SAMPLES).mapToDouble(sample -&gt; {
         <font color="#7F0055"><b>final</b></font> <font color="#7F0055"><b>double</b></font> x = sample[0];
         <font color="#7F0055"><b>final</b></font> <font color="#7F0055"><b>double</b></font> y = sample[1];
         <font color="#7F0055"><b>final</b></font> <font color="#7F0055"><b>double</b></font> result = program.eval(x);
         <font color="#7F0055"><b>return</b></font> abs(y - result) + program.size()*0.00005;
     })
     .sum();
 }</code></div>

 The error function calculates the sum of the (absolute) difference between
 the sample value and the value calculated the by the evolved <em>program</em>
 (<code>ProgramGene</code>). Since we prefer compact programs over complex one, we
 will add a penalty for the program size (the number of nodes of the program
 tree).

 <p>
     <b>CAUTION</b>: <em>The penalty for the tree size must be small enough to
     not dominate the error function. We still want to find an approximating
     function and not the smallest possible one</em>
 </p>

 After we have defined the error function, we need to define the proper
 <code>Codec</code>.

 <div class="code"><code lang="java">
 <font color="#7F0055"><b>static</b></font> <font color="#7F0055"><b>final</b></font> Codec&lt;ProgramGene&lt;Double&gt;, ProgramGene&lt;Double&gt;&gt; CODEC =
     Codec.of(
         Genotype.of(ProgramChromosome.of(
             <font color="#3F7F5F">// Program tree depth.</font>
             5,
             <font color="#3F7F5F">// Chromosome validator.</font>
             ch -&gt; ch.getRoot().size() &lt;= 50,
             OPERATIONS,
             TERMINALS
         )),
         Genotype::getGene
     );</code></div>


 There are two particularities in the definition of the
 <code>ProgramChromosome</code>:

 <ol>
     <li>Since we want to narrow the search space, we are limiting the depth
     of newly created program trees to 5.</li>
     <li>Because of crossover operations performed during evolution, the
     resulting programs can grow quite big. To prevent an unlimited growth of
     the program trees, we mark programs with more than _50_ nodes as
     invalid.</li>
 </ol>

 Now we are ready to put everything together:

 <div class="code"><code lang="java">
 <font color="#7F0055"><b>public</b></font> <font color="#7F0055"><b>static</b></font> <font color="#7F0055"><b>void</b></font> main(<font color="#7F0055"><b>final</b></font> String[] args) {
     <font color="#7F0055"><b>final</b></font> Engine&lt;ProgramGene&lt;Double&gt;, Double&gt; engine = Engine
         .builder(Polynomial::error, CODEC)
         .minimizing()
         .alterers(
             <font color="#7F0055"><b>new</b></font> SingleNodeCrossover&lt;&gt;(),
             <font color="#7F0055"><b>new</b></font> Mutator&lt;&gt;())
         .build();

     <font color="#7F0055"><b>final</b></font> ProgramGene&lt;Double&gt; program = engine.stream()
         .limit(500)
         .collect(EvolutionResult.toBestGenotype())
         .getGene();

     System.out.println(Tree.toString(program));
 }</code></div>

 The GP is capable of finding the polynomial which created the sample data.
 After a few tries, we got the following (correct) output program:

 <pre>
 add
 ├── mul
 │   ├── x
 │   └── sub
 │       ├── 0.0
 │       └── mul
 │           ├── x
 │           └── sub
 │               ├── sub
 │               │   ├── sub
 │               │   │   ├── sub
 │               │   │   │   ├── 3.0
 │               │   │   │   └── x
 │               │   │   └── x
 │               │   └── x
 │               └── x
 └── x
 </pre>

 This program can be reduced to <em>4*x^3 - 3*x^2 + x</em>, which is exactly
 the polynomial, which created the sample data.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>3.9</dd>
<dt><span class="simpleTagLabel">Version:</span></dt>
<dd>3.9</dd>
<dt><span class="simpleTagLabel">Author:</span></dt>
<dd><a href="mailto:franz.wilhelmstoetter@gmail.com">Franz Wilhelmstötter</a></dd>
</dl>
</div>
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Package</li>
<li><a href="../../../io/jenetics/prog/op/package-summary.html">Next&nbsp;Package</a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?io/jenetics/prog/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>&copy; 2007-2017 Franz Wilhelmst&ouml;tter  &nbsp;<i>(2017-11-16 20:09)</i></small></p>
</body>
</html>
